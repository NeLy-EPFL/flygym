<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DF8S7T56G7"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-DF8S7T56G7');
    </script>
    <link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Fly" href="fly.html" /><link rel="prev" title="API Reference" href="index.html" />
        <link rel="prefetch" href="https://github.com/NeLy-EPFL/_media/blob/main/flygym/banner_small.jpg?raw=true" as="image" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>MDP Task Specifications - NeuroMechFly documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">NeuroMechFly documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="https://github.com/NeLy-EPFL/_media/blob/main/flygym/banner_small.jpg?raw=true" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">NeuroMechFly documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../neuromechfly.html">The NeuroMechFly Model</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../gallery/index.html">Gallery</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Gallery</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../gallery/video_3_forces.html">Estimating contact forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/video_4_climbing.html">Climbing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/video_8_controller_comparison.html">Controller comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/video_9_visual_taxis.html">Visual taxis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/video_10_odour_taxis.html">Odour Taxis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/video_11_head_stabilization.html">Head stabilization on complex terrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/video_12_multimodal_navigation.html">Multimodal navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/video_13_plume_navigation.html">Plume navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/video_14_fly_follow_fly.html">Fly chasing with a connectome constrained visual system</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/gym_basics_and_kinematic_replay.html">Interacting with NeuroMechFly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/cpg_controller.html">Controlling locomotion with CPGs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/rule_based_controller.html">Rule-based controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/hybrid_controller.html">Overcome complex terrain with a hybrid controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/turning.html">Encapsulating custom code into Gym environments: A turning controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vision_basics.html">Vision basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/olfaction_basics.html">Olfaction basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/path_integration.html">Path integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/head_stabilization.html">Head stabilization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/advanced_vision.html">Connectome-constrained visual system model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/advanced_olfaction.html">Advanced olfaction: Navigating a complex odor plume</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">MDP Task Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="fly.html">Fly</a></li>
<li class="toctree-l2"><a class="reference internal" href="arena.html">Arena</a></li>
<li class="toctree-l2"><a class="reference internal" href="camera.html">Camera</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="state.html">State</a></li>
<li class="toctree-l2"><a class="reference internal" href="vision.html">Vision</a></li>
<li class="toctree-l2"><a class="reference internal" href="olfaction.html">Olfaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprogrammed.html">Preprogrammed</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="examples/index.html">FlyGym Examples</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of FlyGym Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/locomotion.html">Locomotion</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/vision.html">Advanced Vision</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/olfaction.html">Advanced Olfaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/path_integration.html">Path Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/head_stabilization.html">Head Stabilization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="legacy.html">Legacy API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../workshop.html">NeuroMechFly Workshop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outreach.html">NeuroMechFly Live and Outreach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/api_ref/mdp_specs.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="mdp-task-specifications">
<h1>MDP Task Specifications<a class="headerlink" href="#mdp-task-specifications" title="Link to this heading">¶</a></h1>
<p>As discussed in the <a class="reference external" href="https://neuromechfly.org/tutorials/gym_basics_and_kinematic_replay.html">“Interacting with NeuroMechFly” tutorial</a>, we formulate the control problem as a “task,” or “environment,” which receives an <em>action</em> from the controller and returns (i) an <em>observation</em> of the state of the fly and (ii) a reward (optional). The task also return an <em>info</em> dictionary, which can be used to provide additional information about the task, a <em>terminated</em> flag to indicate whether the task has due to certain conditions being met, and a <em>truncated</em> flag to indicate whether the task has been terminated early due to technical issues (e.g. physics errors, timeout, etc.). On this page, we will specify the content of the <em>action</em>, the <em>observation</em>, and the conditions for <em>termination</em> and <em>truncation</em> to return True.</p>
<section id="default-simulation">
<h2>Default <code class="docutils literal notranslate"><span class="pre">Simulation</span></code><a class="headerlink" href="#default-simulation" title="Link to this heading">¶</a></h2>
<p><strong>Action:</strong> The action space is a <a class="reference external" href="https://gymnasium.farama.org/api/spaces/composite/#dict">Dict space</a> with the following keys:</p>
<ul class="simple">
<li><p>“joints”: The control signal for the actuated DoFs (e.g. if <code class="docutils literal notranslate"><span class="pre">Fly.control</span> <span class="pre">==</span> <span class="pre">&quot;position&quot;</span></code>, then this is the target joint angle). This is a NumPy array of shape (num_actuated_joints,). The order of the DoFs is the same as <code class="docutils literal notranslate"><span class="pre">Fly.actuated_joints</span></code>.</p></li>
<li><p>“adhesion” (if <code class="docutils literal notranslate"><span class="pre">Fly.enable_adhesion</span></code> is True): The on/off signal of leg adhesion as a NumPy array of shape (6,), one for each leg. The order of the legs is: LF, LM, LH, RF, RM, RH (L/R = left/right, F/M/H = front/middle/hind).</p></li>
</ul>
<p><strong>Observation:</strong> The observation space is a Dict space with the following keys:</p>
<ul class="simple">
<li><p>“joints”: The joint states as a NumPy array of shape (3, num_actuated_joints). The three rows are the angle, angular velocity, and force at each DoF. The order of the DoFs is the same as <code class="docutils literal notranslate"><span class="pre">Fly.actuated_joints</span></code></p></li>
<li><p>“fly”: The fly state as a NumPy array of shape (4, 3). 0th row: x, y, z position of the fly in arena. 1st row: x, y, z velocity of the fly in arena. 2nd row: orientation of fly around x, y, z axes. 3rd row: rate of change of fly orientation.</p></li>
<li><p>“contact_forces”: Readings of the touch contact sensors, one placed for each of the body segments specified in <code class="docutils literal notranslate"><span class="pre">Fly.contact_sensor_placements</span></code>. This is a NumPy array of shape (num_contact_sensor_placements, 3).</p></li>
<li><p>“end_effectors”: The positions of the end effectors (most distal tarsus link) of the legs as a NumPy array of shape (6, 3). The order of the legs is: LF, LM, LH, RF, RM, RH (L/R = left/right, F/M/H = front/middle/hind).</p></li>
<li><p>“fly_orientation”: [Deprecated] this entry in the observation space is deprecated and will be removed in future releases. Use the “forward” vector from “cardinal_vectors” instead. Previously, this variable is a NumPy array of shape (3,). This is the vector (x, y, z) pointing toward the direction that the fly is facing.</p></li>
<li><p>“vision” (if <code class="docutils literal notranslate"><span class="pre">Fly.enable_vision</span></code> is True): The light intensities sensed by the ommatidia on the compound eyes. This is a NumPy array of shape (2, num_ommatidia_per_eye, 2), where the zeroth dimension is the side (left, right in that order); the second dimension specifies the ommatidium, and the last column is for the spectral channel (yellow-type, pale-type in that order). Each ommatidium only has one channel with nonzero reading. The intensities are given on a [0, 1] scale.</p></li>
<li><p>“odor_intensity” (if <code class="docutils literal notranslate"><span class="pre">Fly.enable_olfaction</span></code> is True): The odor intensities sensed by the odor sensors (by default 2 antennae and 2 maxillary palps). This is a NumPy array of shape (odor_space_dimension, num_sensors).</p></li>
<li><p>“cardinal_vectors”: The cardinal vectors (forward, left, up) of the fly’s spatial orientation in the global frame. This is a NumPy array of shape (3, 3) where the 0th dimension specifies forward/left/up in that order, and the 1st dimension specifies the x/y/z components of the vector. Note that the forward vector is a bit tiled up; therefore if the fly is walking perfectly forward on the floor, one should expect a non-negligible positive z component in the forward vector (and a non-negligible negative value in the x component of the up vector).</p></li>
</ul>
<p><strong>Info:</strong> The info dictionary contains the following:</p>
<ul class="simple">
<li><p>“vision_updated” (if <code class="docutils literal notranslate"><span class="pre">Fly.enable_vision</span></code> is True): A boolean indicating whether the vision has been updated in the current step. This is useful because the visual input is usually updated at a much lower frequency than the physics simulation.</p></li>
<li><p>“flip” (if <code class="docutils literal notranslate"><span class="pre">Fly.detect_flip</span></code> is True): A boolean indicating whether the fly has flipped upside down.</p></li>
<li><p>“flip_counter” (if <code class="docutils literal notranslate"><span class="pre">Fly.detect_flip</span></code> is True): The number of simulation steps during which all legs of the fly have been off the ground (detected using a threshold of ground contact forces). Useful for debugging.</p></li>
<li><p>“contact_forces” (if <code class="docutils literal notranslate"><span class="pre">Fly.detect_flip</span></code> is True): The contact forces sensed by the legs. Useful for debugging.</p></li>
<li><p>“neck_actuation” (if <code class="docutils literal notranslate"><span class="pre">Fly.head_stabilization_model</span></code> is specified): The neck actuation applied.</p></li>
</ul>
<p><strong>Reward, termination, and truncation:</strong> By default, the task always returns False for the terminated and truncated flags and 0 for the reward. The user is expected to modify this behavior by extending the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> or <code class="docutils literal notranslate"><span class="pre">Fly</span></code> classes as needed.</p>
</section>
<section id="examples-under-flygym-examples">
<h2>Examples under <code class="docutils literal notranslate"><span class="pre">flygym/examples</span></code><a class="headerlink" href="#examples-under-flygym-examples" title="Link to this heading">¶</a></h2>
<section id="hybrid-turning-controller-hybridturningcontroller">
<h3>Hybrid turning controller (<code class="docutils literal notranslate"><span class="pre">HybridTurningController</span></code>)<a class="headerlink" href="#hybrid-turning-controller-hybridturningcontroller" title="Link to this heading">¶</a></h3>
<p><strong>Action</strong>: The <code class="docutils literal notranslate"><span class="pre">flygym.example.locomotion.HybridTurningController</span></code> class expects a single NumPy array of shape (2,) as its action. The values are the descending walking drive on the left and right sides of the fly. See the <a class="reference external" href="https://neuromechfly.org/tutorials/turning.html">tutorial on the hybrid turning controller</a> for more details.</p>
<p><strong>Observation, reward, termination, and truncation:</strong> The <code class="docutils literal notranslate"><span class="pre">flygym.example.locomotion.HybridTurningController</span></code> class returns the same observation, reward, “terminated” flag, and “truncated” flag as the default <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> class.</p>
<p><strong>Info:</strong> In addition to what is provided in the default <code class="docutils literal notranslate"><span class="pre">Simulation</span></code>, the <code class="docutils literal notranslate"><span class="pre">flygym.example.locomotion.HybridTurningController</span></code> class includes the following in the “info” dictionary:</p>
<ul class="simple">
<li><p>“joints”, “adhesion”: The hybrid turning controller computes the appropriate joint angles and adhesion signals based on the descending inputs, CPG states, and mechanosensory feedback. These values are the computed low-level motor commands applied to the underlying base <code class="docutils literal notranslate"><span class="pre">Simulation</span></code>.</p></li>
<li><p>“net_corrections”: The net correction amounts applied to the legs as a NumPy array of shape (6,). Refer to the <a class="reference external" href="https://neuromechfly.org/tutorials/hybrid_controller.html">tutorial on the hybrid turning controller</a> for more details. The order of legs is: LF, LM, LH, RF, RM, RH (L/R = left/right, F/M/H = front/middle/hind).</p></li>
</ul>
</section>
<section id="simple-object-following-visualtaxis">
<h3>Simple object following (<code class="docutils literal notranslate"><span class="pre">VisualTaxis</span></code>)<a class="headerlink" href="#simple-object-following-visualtaxis" title="Link to this heading">¶</a></h3>
<p><strong>Action:</strong> The <code class="docutils literal notranslate"><span class="pre">flygym.example.vision.VisualTaxis</span></code> class expects the same action as <code class="docutils literal notranslate"><span class="pre">HybridTurningController</span></code>.</p>
<p><strong>Observation:</strong> The <code class="docutils literal notranslate"><span class="pre">flygym.example.vision.VisualTaxis</span></code> class returns an array of shape (2, 3) as the observation. The two rows of the array specify the left vs. right eyes (in this order). The three columns are the azimuth (left-right) and elevation (top-down) positions of the object in the visual field, and the size of the object in the visual field. All values are normalized, either by the width/height or by the size of the visual field, to the range [0, 1].</p>
<p><strong>Reward, termination, truncation, and info:</strong> The <code class="docutils literal notranslate"><span class="pre">flygym.example.vision.VisualTaxis</span></code> class always returns 0 for the reward, False for the “terminated” and “truncated” flags, and an empty dictionary for the “info” dictionary.</p>
</section>
<section id="path-integration-task-pathintegrationcontroller">
<h3>Path integration task (<code class="docutils literal notranslate"><span class="pre">PathIntegrationController</span></code>)<a class="headerlink" href="#path-integration-task-pathintegrationcontroller" title="Link to this heading">¶</a></h3>
<p><strong>Action, reward, termination, truncation, and info:</strong> The <code class="docutils literal notranslate"><span class="pre">flygym.examples.path_integration.PathIntegrationController</span></code> class returns the same action, observation, reward, “terminated” flag, “truncated” flag, and “info” dictionary as <code class="docutils literal notranslate"><span class="pre">HybridTurningController</span></code>.</p>
<p><strong>Observation:</strong> In addition to what is returned by <code class="docutils literal notranslate"><span class="pre">HybridTurningController</span></code>, <code class="docutils literal notranslate"><span class="pre">flygym.examples.path_integration.PathIntegrationController</span></code> also provides the following in the observation dictionary:</p>
<ul class="simple">
<li><p>“stride_diff_unmasked”: The relative shift of the tips of the legs from one simulation step to another. The shift is computed in the reference from of the fly and presented as a NumPy array of shape (6, 3). The order of the legs (0th axis of the array) is: LF, LM, LH, RF, RM, RH (L/R = left/right, F/M/H = front/middle/hind). The 1st axis of the array is the x, y, z components of the shift. The shift is computed by comparing the positions of the legs in the current step with the positions in the previous step. The shift is not masked by the leg’s contact with the ground.</p></li>
</ul>
</section>
<section id="plume-tracking-task-plumenavigationtask">
<h3>Plume tracking task (<code class="docutils literal notranslate"><span class="pre">PlumeNavigationTask</span></code>)<a class="headerlink" href="#plume-tracking-task-plumenavigationtask" title="Link to this heading">¶</a></h3>
<p><strong>Action, observation, reward, termination, info:</strong> The <code class="docutils literal notranslate"><span class="pre">flygym.examples.olfaction.PlumeNavigationTask</span></code> class expects the same action and returns the observation, reward, “terminated” flag, and “info” dictionary as <code class="docutils literal notranslate"><span class="pre">HybridTurningController</span></code>.</p>
<p><strong>Truncation:</strong> The <code class="docutils literal notranslate"><span class="pre">flygym.examples.olfaction.PlumeNavigationTask</span></code> class returns True for the “truncated” flag if and only if the fly has left the area on the arena where the plume is simulated.</p>
</section>
<section id="neuromechfly-with-connectome-constrained-vision-network-realisticvisionfly">
<h3>NeuroMechFly with connectome-constrained vision network (<code class="docutils literal notranslate"><span class="pre">RealisticVisionFly</span></code>)<a class="headerlink" href="#neuromechfly-with-connectome-constrained-vision-network-realisticvisionfly" title="Link to this heading">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">RealisticVisionFly</span></code> is an extension of <code class="docutils literal notranslate"><span class="pre">Fly</span></code>, not <code class="docutils literal notranslate"><span class="pre">Simulation</span></code>. The action and observation spaces of the simulation are modified accordingly nonetheless at the level of each flies.</p>
</div>
<p><strong>Action, reward, termination, and truncation:</strong> The <code class="docutils literal notranslate"><span class="pre">flygym.examples.vision.RealisticVisionFly</span></code> class expects the same action and returns the same reward, “terminated” flag, and “truncated” flags as <code class="docutils literal notranslate"><span class="pre">HybridTurningController</span></code>.</p>
<p><strong>Observation:</strong> In addition to what is returned by the <code class="docutils literal notranslate"><span class="pre">HybridTurningController</span></code>, the <code class="docutils literal notranslate"><span class="pre">flygym.examples.vision.RealisticVisionFly</span></code> class also provides the following in the observation dictionary:</p>
<ul class="simple">
<li><p>“nn_activities_arr”: The activities of the visual system neurons, represented as a NumPy array of shape (2, num_cells_per_eye). The 0th dimension corresponds to the eyes in the order (left, right).</p></li>
</ul>
<p><strong>Info:</strong> In addition to what is returned by the <code class="docutils literal notranslate"><span class="pre">HybridTurningController</span></code>, the <code class="docutils literal notranslate"><span class="pre">flygym.examples.vision.RealisticVisionFly</span></code> class also provides the following in the “info” dictionary:</p>
<ul class="simple">
<li><p>“nn_activities”: Activities of the visual system neurons as a <code class="docutils literal notranslate"><span class="pre">flyvis.LayerActivity</span></code> object. This is similar to <code class="docutils literal notranslate"><span class="pre">obs[&quot;nn_activities_arr&quot;]</span></code> but in the form of a <code class="docutils literal notranslate"><span class="pre">flyvis.LayerActivity</span></code> object rather than a plain array.</p></li>
</ul>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="fly.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Fly</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">API Reference</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Neuroengineering Laboratory, EPFL
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/NeLy-EPFL/flygym" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">MDP Task Specifications</a><ul>
<li><a class="reference internal" href="#default-simulation">Default <code class="docutils literal notranslate"><span class="pre">Simulation</span></code></a></li>
<li><a class="reference internal" href="#examples-under-flygym-examples">Examples under <code class="docutils literal notranslate"><span class="pre">flygym/examples</span></code></a><ul>
<li><a class="reference internal" href="#hybrid-turning-controller-hybridturningcontroller">Hybrid turning controller (<code class="docutils literal notranslate"><span class="pre">HybridTurningController</span></code>)</a></li>
<li><a class="reference internal" href="#simple-object-following-visualtaxis">Simple object following (<code class="docutils literal notranslate"><span class="pre">VisualTaxis</span></code>)</a></li>
<li><a class="reference internal" href="#path-integration-task-pathintegrationcontroller">Path integration task (<code class="docutils literal notranslate"><span class="pre">PathIntegrationController</span></code>)</a></li>
<li><a class="reference internal" href="#plume-tracking-task-plumenavigationtask">Plume tracking task (<code class="docutils literal notranslate"><span class="pre">PlumeNavigationTask</span></code>)</a></li>
<li><a class="reference internal" href="#neuromechfly-with-connectome-constrained-vision-network-realisticvisionfly">NeuroMechFly with connectome-constrained vision network (<code class="docutils literal notranslate"><span class="pre">RealisticVisionFly</span></code>)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>